{"version":3,"file":"page-BrO25Ey9.js","sources":["../../src/pages/user/support/page.tsx"],"sourcesContent":["\nimport { useEffect, useState } from 'react';\nimport { useAuth } from '../../../contexts/AuthContext';\nimport { supabase, SupportRecord } from '../../../lib/supabase';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function UserSupport() {\n  const { profile } = useAuth();\n  const navigate = useNavigate();\n  const [records, setRecords] = useState<SupportRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedType, setSelectedType] = useState<string>('all');\n  const [viewRecord, setViewRecord] = useState<SupportRecord | null>(null);\n\n  useEffect(() => {\n    fetchRecords();\n  }, [profile]);\n\n  const fetchRecords = async () => {\n    if (!profile) return;\n\n    const { data } = await supabase\n      .from('support_records')\n      .select('*')\n      .eq('user_id', profile.id)\n      .order('created_at', { ascending: false });\n\n    if (data) {\n      setRecords(data);\n    }\n    setLoading(false);\n  };\n\n  const filteredRecords = records.filter((record) => {\n    if (selectedType !== 'all' && record.record_type !== selectedType) return false;\n    return true;\n  });\n\n  const getTypeLabel = (type: string) => {\n    return type === 'plan' ? '個別支援計画' : 'ケース記録';\n  };\n\n  const getTypeColor = (type: string) => {\n    return type === 'plan' \n      ? 'bg-blue-100 text-blue-700' \n      : 'bg-green-100 text-green-700';\n  };\n\n  const getTypeIcon = (type: string) => {\n    return type === 'plan' ? 'ri-file-text-line' : 'ri-draft-line';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={() => navigate('/user/dashboard')}\n              className=\"w-10 h-10 flex items-center justify-center text-gray-600 hover:bg-gray-100 rounded-lg transition-colors cursor-pointer\"\n            >\n              <i className=\"ri-arrow-left-line text-xl\"></i>\n            </button>\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">支援記録</h1>\n              <p className=\"text-sm text-gray-600 mt-1\">個別支援計画・ケース記録の閲覧</p>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* フィルター */}\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4 mb-6\">\n          <div className=\"flex items-center gap-4\">\n            <label className=\"text-sm font-medium text-gray-700\">記録種別:</label>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={() => setSelectedType('all')}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap cursor-pointer ${\n                  selectedType === 'all'\n                    ? 'bg-indigo-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                すべて\n              </button>\n              <button\n                onClick={() => setSelectedType('plan')}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap cursor-pointer ${\n                  selectedType === 'plan'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                個別支援計画\n              </button>\n              <button\n                onClick={() => setSelectedType('case_note')}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap cursor-pointer ${\n                  selectedType === 'case_note'\n                    ? 'bg-green-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                ケース記録\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* 統計 */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center\">\n                <i className=\"ri-file-list-3-line text-indigo-600\"></i>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">総記録数</p>\n                <p className=\"text-xl font-bold text-gray-900\">{records.length}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\n                <i className=\"ri-file-text-line text-blue-600\"></i>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">個別支援計画</p>\n                <p className=\"text-xl font-bold text-gray-900\">\n                  {records.filter((r) => r.record_type === 'plan').length}\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center\">\n                <i className=\"ri-draft-line text-green-600\"></i>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">ケース記録</p>\n                <p className=\"text-xl font-bold text-gray-900\">\n                  {records.filter((r) => r.record_type === 'case_note').length}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* 記録一覧 */}\n        {loading ? (\n          <div className=\"text-center py-12\">\n            <div className=\"inline-block w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin\"></div>\n            <p className=\"mt-4 text-gray-600\">読み込み中...</p>\n          </div>\n        ) : filteredRecords.length === 0 ? (\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center\">\n            <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <i className=\"ri-file-list-3-line text-3xl text-gray-400\"></i>\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">記録がありません</h3>\n            <p className=\"text-gray-600\">支援記録はまだ作成されていません</p>\n          </div>\n        ) : (\n          <div className=\"grid gap-4\">\n            {filteredRecords.map((record) => (\n              <div\n                key={record.id}\n                onClick={() => setViewRecord(record)}\n                className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all cursor-pointer\"\n              >\n                <div className=\"flex items-start justify-between gap-4\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-3\">\n                      <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${\n                        record.record_type === 'plan' ? 'bg-blue-100' : 'bg-green-100'\n                      }`}>\n                        <i className={`${getTypeIcon(record.record_type)} ${\n                          record.record_type === 'plan' ? 'text-blue-600' : 'text-green-600'\n                        }`}></i>\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 flex-wrap\">\n                          <h3 className=\"text-lg font-bold text-gray-900\">{record.title}</h3>\n                          <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${getTypeColor(record.record_type)}`}>\n                            {getTypeLabel(record.record_type)}\n                          </span>\n                        </div>\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          記録日: {new Date(record.record_date || record.created_at).toLocaleDateString('ja-JP')}\n                        </p>\n                      </div>\n                    </div>\n                    <p className=\"text-gray-700 line-clamp-2\">{record.content}</p>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-gray-400 text-xl\"></i>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </main>\n\n      {/* 詳細表示モーダル */}\n      {viewRecord && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6 border-b border-gray-100\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${getTypeColor(viewRecord.record_type)}`}>\n                    {getTypeLabel(viewRecord.record_type)}\n                  </span>\n                </div>\n                <button\n                  onClick={() => setViewRecord(null)}\n                  className=\"w-10 h-10 flex items-center justify-center text-gray-400 hover:bg-gray-100 rounded-lg transition-colors cursor-pointer\"\n                >\n                  <i className=\"ri-close-line text-2xl\"></i>\n                </button>\n              </div>\n            </div>\n\n            <div className=\"p-6\">\n              <div className=\"mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900 mb-2\">{viewRecord.title}</h2>\n                <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n                  <i className=\"ri-calendar-line\"></i>\n                  <span>\n                    {new Date(viewRecord.record_date || viewRecord.created_at).toLocaleDateString('ja-JP', {\n                      year: 'numeric',\n                      month: 'long',\n                      day: 'numeric',\n                    })}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"bg-gray-50 rounded-lg p-4 mb-6\">\n                <h3 className=\"text-sm font-medium text-gray-700 mb-2\">記録内容</h3>\n                <p className=\"text-gray-700 whitespace-pre-wrap\">{viewRecord.content}</p>\n              </div>\n\n              <div className=\"flex justify-end\">\n                <button\n                  onClick={() => setViewRecord(null)}\n                  className=\"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium whitespace-nowrap cursor-pointer\"\n                >\n                  閉じる\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["UserSupport","profile","useAuth","navigate","useNavigate","records","setRecords","useState","loading","setLoading","selectedType","setSelectedType","viewRecord","setViewRecord","useEffect","fetchRecords","data","supabase","filteredRecords","record","getTypeLabel","type","getTypeColor","getTypeIcon","jsxs","jsx","r"],"mappings":"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"}