import{a as k,u as S,r as c,j as e,s as r}from"./index-CQCmJ27i.js";function A(){const{profile:a,loading:l,signOut:x}=k(),n=S(),[i,m]=c.useState({totalUsers:0,todayAttendance:0,activeTasks:0,announcements:0}),[D,u]=c.useState(!0);if(c.useEffect(()=>{if(!l){if(!a){n("/login");return}if(a?.role!=="admin"){n("/user/dashboard");return}g()}},[a,l,n]),l)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})});const g=async()=>{const t=new Date,s=new Date(t.toLocaleString("en-US",{timeZone:"Asia/Tokyo"})),j=s.getFullYear(),f=String(s.getMonth()+1).padStart(2,"0"),y=String(s.getDate()).padStart(2,"0"),o=`${j}-${f}-${y}`;console.log("今日の日付（JST）:",o);const[N,d,v,w]=await Promise.all([r.from("profiles").select("id",{count:"exact",head:!0}).eq("role","user"),r.from("attendance").select("id",{count:"exact",head:!0}).eq("date",o),r.from("work_tasks").select("id",{count:"exact",head:!0}),r.from("announcements").select("id",{count:"exact",head:!0})]);console.log("勤怠入力者数:",d.count),m({totalUsers:N.count||0,todayAttendance:d.count||0,activeTasks:v.count||0,announcements:w.count||0}),u(!1)},h=async()=>{await x(),n("/login")},p=[{title:"勤怠管理",description:"利用者の出勤状況を確認",icon:"ri-calendar-check-line",color:"bg-blue-500",path:"/admin/attendance"},{title:"作業管理",description:"作業内容と進捗を管理",icon:"ri-task-line",color:"bg-purple-500",path:"/admin/work"},{title:"連絡掲示板",description:"お知らせを管理",icon:"ri-notification-line",color:"bg-green-500",path:"/admin/announcements"},{title:"支援記録",description:"個別支援計画・ケース記録",icon:"ri-file-list-3-line",color:"bg-orange-500",path:"/admin/support"},{title:"相談窓口",description:"相談内容を確認",icon:"ri-question-answer-line",color:"bg-orange-500",path:"/admin/consultation"},{title:"マニュアル管理",description:"資料・動画を管理",icon:"ri-book-line",color:"bg-pink-500",path:"/admin/manuals"},{title:"ユーザー管理",description:"利用者情報を管理",icon:"ri-user-settings-line",color:"bg-gray-500",path:"/admin/users"},{title:"統計・レポート",description:"月次の勤怠統計と作業実績",icon:"ri-bar-chart-box-line",color:"bg-indigo-500",path:"/admin/reports"}],b=[{label:"登録利用者数",value:i.totalUsers,icon:"ri-user-line",color:"bg-gray-500"},{label:"勤怠入力者数",value:i.todayAttendance,icon:"ri-time-line",color:"bg-blue-500"},{label:"進行中の作業",value:i.activeTasks,icon:"ri-task-line",color:"bg-purple-500"},{label:"お知らせ数",value:i.announcements,icon:"ri-notification-line",color:"bg-green-500"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"アルファサービス"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"管理者ダッシュボード"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a?.username}),e.jsx("p",{className:"text-xs text-gray-500",children:"管理者"})]}),e.jsxs("button",{onClick:h,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-logout-box-line mr-2"}),"ログアウト"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["ようこそ、",a?.username,"さん"]}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"今日の日付"}),e.jsx("p",{className:"text-2xl font-bold",children:new Date().toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"long"})})]}),e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-shield-check-line text-3xl"})})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"統計情報"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:b.map((t,s)=>e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`${t.color} w-12 h-12 rounded-lg flex items-center justify-center text-white`,children:e.jsx("i",{className:`${t.icon} text-2xl`})}),e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:t.value})]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.label})]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"管理メニュー"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((t,s)=>e.jsx("button",{onClick:()=>n(t.path),className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all text-left cursor-pointer border border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`${t.color} w-12 h-12 rounded-lg flex items-center justify-center text-white flex-shrink-0`,children:e.jsx("i",{className:`${t.icon} text-2xl`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]}),e.jsx("i",{className:"ri-arrow-right-s-line text-gray-400 text-xl"})]})},s))})]})]})]})}export{A as default};
//# sourceMappingURL=page-BVN4nxlH.js.map
