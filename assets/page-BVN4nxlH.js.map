{"version":3,"file":"page-BVN4nxlH.js","sources":["../../src/pages/admin/dashboard/page.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useAuth } from '../../../contexts/AuthContext';\nimport { supabase } from '../../../lib/supabase';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function AdminDashboard() {\n  const { profile, loading: authLoading, signOut } = useAuth();\n  const navigate = useNavigate();\n  const [stats, setStats] = useState({\n    totalUsers: 0,\n    todayAttendance: 0,\n    activeTasks: 0,\n    announcements: 0,\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // 認証状態の読み込みが完了するまで待つ\n    if (authLoading) return;\n\n    if (!profile) {\n      navigate('/login');\n      return;\n    }\n\n    if (profile?.role !== 'admin') {\n      navigate('/user/dashboard');\n      return;\n    }\n    fetchStats();\n  }, [profile, authLoading, navigate]);\n\n  // 認証状態の読み込み中は何も表示しない\n  if (authLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">読み込み中...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const fetchStats = async () => {\n    // 日本時間（JST）で今日の日付を取得\n    const now = new Date();\n    const jstDate = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Tokyo' }));\n    const year = jstDate.getFullYear();\n    const month = String(jstDate.getMonth() + 1).padStart(2, '0');\n    const day = String(jstDate.getDate()).padStart(2, '0');\n    const today = `${year}-${month}-${day}`;\n\n    console.log('今日の日付（JST）:', today);\n\n    const [usersResult, attendanceResult, tasksResult, announcementsResult] = await Promise.all([\n      supabase.from('profiles').select('id', { count: 'exact', head: true }).eq('role', 'user'),\n      supabase.from('attendance').select('id', { count: 'exact', head: true }).eq('date', today),\n      supabase.from('work_tasks').select('id', { count: 'exact', head: true }),\n      supabase.from('announcements').select('id', { count: 'exact', head: true }),\n    ]);\n\n    console.log('勤怠入力者数:', attendanceResult.count);\n\n    setStats({\n      totalUsers: usersResult.count || 0,\n      todayAttendance: attendanceResult.count || 0,\n      activeTasks: tasksResult.count || 0,\n      announcements: announcementsResult.count || 0,\n    });\n\n    setLoading(false);\n  };\n\n  const handleSignOut = async () => {\n    await signOut();\n    navigate('/login');\n  };\n\n  const menuItems = [\n    {\n      title: '勤怠管理',\n      description: '利用者の出勤状況を確認',\n      icon: 'ri-calendar-check-line',\n      color: 'bg-blue-500',\n      path: '/admin/attendance',\n    },\n    {\n      title: '作業管理',\n      description: '作業内容と進捗を管理',\n      icon: 'ri-task-line',\n      color: 'bg-purple-500',\n      path: '/admin/work',\n    },\n    {\n      title: '連絡掲示板',\n      description: 'お知らせを管理',\n      icon: 'ri-notification-line',\n      color: 'bg-green-500',\n      path: '/admin/announcements',\n    },\n    {\n      title: '支援記録',\n      description: '個別支援計画・ケース記録',\n      icon: 'ri-file-list-3-line',\n      color: 'bg-orange-500',\n      path: '/admin/support',\n    },\n    {\n      title: '相談窓口',\n      description: '相談内容を確認',\n      icon: 'ri-question-answer-line',\n      color: 'bg-orange-500',\n      path: '/admin/consultation',\n    },\n    {\n      title: 'マニュアル管理',\n      description: '資料・動画を管理',\n      icon: 'ri-book-line',\n      color: 'bg-pink-500',\n      path: '/admin/manuals',\n    },\n    {\n      title: 'ユーザー管理',\n      description: '利用者情報を管理',\n      icon: 'ri-user-settings-line',\n      color: 'bg-gray-500',\n      path: '/admin/users',\n    },\n    {\n      title: '統計・レポート',\n      description: '月次の勤怠統計と作業実績',\n      icon: 'ri-bar-chart-box-line',\n      color: 'bg-indigo-500',\n      path: '/admin/reports',\n    },\n  ];\n\n  const statCards = [\n    { label: '登録利用者数', value: stats.totalUsers, icon: 'ri-user-line', color: 'bg-gray-500' },\n    { label: '勤怠入力者数', value: stats.todayAttendance, icon: 'ri-time-line', color: 'bg-blue-500' },\n    { label: '進行中の作業', value: stats.activeTasks, icon: 'ri-task-line', color: 'bg-purple-500' },\n    { label: 'お知らせ数', value: stats.announcements, icon: 'ri-notification-line', color: 'bg-green-500' },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">アルファサービス</h1>\n              <p className=\"text-sm text-gray-600 mt-1\">管理者ダッシュボード</p>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <div className=\"text-right\">\n                <p className=\"text-sm font-medium text-gray-900\">{profile?.username}</p>\n                <p className=\"text-xs text-gray-500\">管理者</p>\n              </div>\n              <button\n                onClick={handleSignOut}\n                className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium whitespace-nowrap cursor-pointer\"\n              >\n                <i className=\"ri-logout-box-line mr-2\"></i>\n                ログアウト\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">ようこそ、{profile?.username}さん</h2>\n          <div className=\"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 text-white\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm opacity-90 mb-1\">今日の日付</p>\n                <p className=\"text-2xl font-bold\">{new Date().toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' })}</p>\n              </div>\n              <div className=\"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center\">\n                <i className=\"ri-shield-check-line text-3xl\"></i>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mb-8\">\n          <h3 className=\"text-lg font-bold text-gray-900 mb-4\">統計情報</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            {statCards.map((stat, index) => (\n              <div key={index} className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className={`${stat.color} w-12 h-12 rounded-lg flex items-center justify-center text-white`}>\n                    <i className={`${stat.icon} text-2xl`}></i>\n                  </div>\n                  <span className=\"text-3xl font-bold text-gray-900\">{stat.value}</span>\n                </div>\n                <p className=\"text-sm text-gray-600\">{stat.label}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div>\n          <h3 className=\"text-lg font-bold text-gray-900 mb-4\">管理メニュー</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {menuItems.map((item, index) => (\n              <button\n                key={index}\n                onClick={() => navigate(item.path)}\n                className=\"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all text-left cursor-pointer border border-gray-100\"\n              >\n                <div className=\"flex items-start gap-4\">\n                  <div className={`${item.color} w-12 h-12 rounded-lg flex items-center justify-center text-white flex-shrink-0`}>\n                    <i className={`${item.icon} text-2xl`}></i>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-bold text-gray-900 mb-1\">{item.title}</h4>\n                    <p className=\"text-sm text-gray-600\">{item.description}</p>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-gray-400 text-xl\"></i>\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":["AdminDashboard","profile","authLoading","signOut","useAuth","navigate","useNavigate","stats","setStats","useState","loading","setLoading","useEffect","fetchStats","jsxs","jsx","now","jstDate","year","month","day","today","usersResult","attendanceResult","tasksResult","announcementsResult","supabase","handleSignOut","menuItems","statCards","stat","index","item"],"mappings":"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"}